---
layout: post
title: Windows 操作
categories: Windows
tags: delete
---


## 删除顽固文件

    step 1.新建txt文本 输入一下命令并保存

            QUOTE:

    DEL /F /A /Q \\?\%1

    RD /S /Q \\?\%1

    step 2.重命名文本文档为“删除.bat”

    step 3.把要删除的文件/文件夹拖到“删除.bat”

    step 4.完成删除 

## Windows7修改hosts提示：您没有权限在此位置中保存文件

1、未做任何修改的情况下，修改了 hosts 文件，保存时，会出现如图所示的对话框。

　　尽管是我已经是管理员帐户，但是还是无法直接成功保存。

2、正确的方法是，右键单击该文件，选择【属性】，转到【安全】选项卡，单击【编辑】（红圈处），选择当前帐户（红线处），勾选【完全控制】（红框处），确定后就可以正确保存该文件了。

## windows7旗舰版正版无限制激活激活码CD-KEY

    KH2J9-PC326-T44D4-39H6V-TVPBY
    TFP9Y-VCY3P-VVH3T-8XXCC-MF4YK
    236TW-X778T-8MV9F-937GT-QVKBB
    87VT2-FY2XW-F7K39-W3T8R-XMFGF
    J783Y-JKQWR-677Q8-KCXTF-BHWGC
    C4M9W-WPRDG-QBB3F-VM9K8-KDQ9Y
    2VCGQ-BRVJ4-2HGJ2-K36X9-J66JG
    MGX79-TPQB9-KQ248-KXR2V-DHRTD
    FJHWT-KDGHY-K2384-93CT7-323RC
    TFP9Y-VCY3P-VVH3T-8XXCC-MF4YK
    KH2J9-PC326-T44D4-39H6V-TVPBY

## 查看端口号

由于多数邮箱的smtp端口都是25，如果你的服务器不支持25端口，就不能使用smtp发送邮件了，而只能用php发送。但如果遇到国外服务器，php发送邮件容易出现邮件乱码问题。

如果服务器不支持25端口，一般会支持465、587等端口。比如gmail的邮箱就是支持465、587端口。
本人使用过上面所说情况的服务器。我使用wp博客系统，采用gmail邮箱的smtp发送邮件很快而且正常，但是有DZ、UChome系统就不行了。其他邮箱多是25端口，根本不能使用。

我使用php发送邮件，gmail邮箱收到邮件正常，但其他邮箱收到邮件是乱码，用改变字符集无法解决。

为此，我想了许多办法，发了无数求救帖子，得到许多专家的关注，还是找不到解决良策。也想到DZ、UChome的版本、字符等问题，不断更换和试验，还是无策。但最终找到办法解决了，受到网友们的启发，实现了用gmail发送邮件。

其实办法很简单。以gmail邮箱为例：

    1、网友说要验证服务器是否支持OpenSSL，我看不一定。我的服务器就不支持。
    2、要设置gmail，开放pop、smtp等。
    3、在uchome的管理里面，邮件发送方式：选择“通过 SOCKET 连接 SMTP 服务器发送(支持 ESMTP 验证)”，SMTP 服务器填写为：ssl://smtp.gmail.com ，SMTP 端口填写为：465 。

其余就是把邮箱地址、密码设置正确。确认就OK。

这里最关键的是SMTP服务器一定要设置为“ssl://smtp.gmail.com ”而不是“smtp.gmail.com  ”。

原因是gmail走的是加密的ssl协议，所以前面要加ssl://。

google的企业邮局同样适用。

不过，也有的国外服务器不支持ssl，一般可以使用PHP发送了。


开始-->运行-->输入services.msc 确定,找到Simple Mail Transfer Protocol (SMTP)
-->右键-->属性 可执行文件路径下面的下面有个启动类型,选为自动 然后确定就是了!

## 端口占用查看

netstat -help

获取帮助

netstat -o:可以查看端口对应的进程id,PID

若查出端口号为：8080，这时可以对应命令：wmic

process where ProcessId="8080"，可以查看出对应的进程，如果要kill掉这个进程 ：tskill进程号

## 进程查看

wmic

process where Caption="java.exe"

## Windows无法访问指定设备,路径或文件..解决方法

是权限问题：

先找到安装文件夹，属性——安全——高级——所有者——编辑，把所有者设成你的帐号，注意不是管理员的，且要替换子容器和对象的所有者。

回到高级——权限——更改权限，允许你的帐号完全控制。包括可从该对象的的父项继承的权限不知道要不要选，我没选。使用可从此对象继承的权限替换所有子对象权限要选。确定就可以了 

## 试图共享时出现错误,没有启动服务器服务,此时尚未创建共享资源

解决方法：

方法一：

    在桌面=>>我的电脑=>>右键=>>管理...=>>
    服务和应用程序=>>服务
    在右边的窗口里找到 Server 这个服务
    在 Server 上点右键=>>属性
    把启动类型改为自动,再点下面的启动按钮
    再点确定
    OK 

方法二：

    控制面板——管理工具——服务
    找到Server这个服务，启动，并设置为自动 

方法三：

    右键我的电脑   管理  服务    server服务是否启动  workstantion是否启用

## 无法访问共享资源

对2000B机器进行如下设置： 

1．启用Guest账号 

在很多情况下，为了本机系统的安全，Guest账户是被禁用的，这样就无法访问该机器的共享资源，因此必须启用Guest账户。 

笔者以Windows XP系统为例进行介绍。在共享资源提供端，进入到“控制面板→管理工具”后，运行“计算机管理”工具，接着依次展开“计算机管理（本地）→系统工具→本地用户和组→用户”，找到Guest账户。如果Guest账户出现一个红色的叉号，表明该账户已被停用，右键单击该账号，在Guest属性对话框中，去除“账户已停用”的钩选标记，单击“确定”后，就启用了Guest账户。此方法适用于Windows 2000/XP/2003系统。 

提示：使用Guest账户访问共享资源存在很大的安全隐患。当然我们也可以为每个访问用户创建一个指定的账号。首先在共享资源提供端创建一个新的账号，然后指定该账号的访问权限。接下来在要访问该共享资源的客户机中新建一个相同用户名和密码的账号，使用此账号登录客户机后，就能正常访问该账号所允许的共享资源。此方法较为安全，但要为网络中的每个用户都创建一个账号，不适合规模较大的网络。 

2．修改用户访问策略 

虽然启用了本机的Guest账号，但用户还是不能访问本机提供的共享资源，这是因为组策略默认不允许Guest账号从网络访问本机。 

单击“开始→运行”，在运行框中输入“gpedit.msc”，在组策略窗口中依次展开“本地计算机策略→计算机配置→Windows设置→安全设置→本地策略→用户权利指派”（图1），在右栏中找到“拒绝从网络访问这台计算机”项，打开后删除其中的Guest账号，接着打开“从网络访问此计算机”项，在属性窗口中添加Guest账号。这样就能使用Guest账号从网络中访问该机的共享资源了。此方法适用于Windows 2000/XP/2003系统。 

3．正确配置网络防火墙 

很多机器安装了网络防火墙，它的设置不当，同样导致用户无法访问本机的共享资源，这时就要开放本机共享资源所需的NetBIOS端口。笔者以天网防火墙为例，在“自定义IP规则”窗口中选中“允许局域网的机器使用我的共享资源”规则，最后点击“保存”按钮，这样就开放了NetBIOS端口 。

4．合理设置用户访问权限 

网络中很多机器使用 NTFS文件系统，它的ACL功能（访问控制列表）可以对用户的访问权限进行控制，用户要访问这些机器的共享资源，必须赋予相应的权限才行。如使用Guest账号访问该机器的CPCW共享文件夹，右键点击该共享目录，选择“属性”，切换到“安全”标签页，然后将Guest账号添加到用户列表中，接着指定Guest的访问权限，至少要赋予“读取”和“列出文件夹目录”权限（图2）。如果想让多个用户账号能访问该共享目录，只需要添加Eeryone账号，然后赋予“读取”和“列出文件夹?..

## 显卡占用内存调节

查看内存：命令行输入：dxdiag

可以看到大概内存和显示占的内存，如果这时显卡占的内存过大的话，可以调节：

进入BIOS，找到显卡设置选项，发现“onboard VGA share memory”一栏的默认设置为AUTO，意思即是：显卡共享的内存设置是自动的。按下“Enter”后，在弹出选择栏里有AUTO、8MB、16MB、 32MB、64MB 128MB 256mb等，这样集成显卡占用的内存就是可调节的。，将其设为256MB或更高，按F10存盘退出，系统成功启动后，右键单击“我的电脑”，在弹出的属 性对话框中，果然发现内存容量有了变化，即为成功。

关于显存设置方面的

如果是512内存,则显存集成显卡的显存调到64MB

如果是1G的内存,集成显卡的显存可以调到128MB...

基本上这样就可以了

## 远程桌面登录蓝屏、不显示桌面问题解决方法

目前使用远程桌面进行远程管理服务器的用户估计会遇到远程桌面登陆服务器后显示黑屏，或无法显示桌面无法进行操作的问题，您可以尝试以下操作方法对远程桌面进行激活。

使用远程桌面，输入您服务器IP地址登陆服务器

登陆后出现黑屏或无法显示桌面是请您按下Ctrl+Alt+End键，激活远程桌面中的任务管理器

点击激活窗口中“任务管理器”后，结束查看进程标签中explorer.exe进程，选中该进程，并点击右下角“结束进程”，将该进程结束。

然后您在“Windows 任务管理器”窗口中点击“文件”---“新建任务(运行...)”---“浏览”在浏览中选择“C:\WINDOWS\explorer.exe”程序---“确定”，即可激活远程服务器。

## DNS

福建电信DNS 218.85.152.99 , 218.85.157.99

首先要知道DNS的作用是什么：就是记录域名和IP地址之间的对应关系。因为我们在上网的时候输入的www.sina.com是个域名，而最终访问网络的是这个域名对应的IP地址，它们之间的解析过程就是DNS服务器完成的。

首选DNS指的是本地DNS服务器的IP地址，域名和IP之间的解析有该服务器完成。备用DNS服务器指的是如果首选DNS服务器的不能工作了，那么解析的任务就有备用DNS服务器完成。前提条件是备用的DNS服务器必须是可用的，

## 查看java进程

开始-->运行 wmic  出现dos窗口后输入 process

可以查看所有的进程

如果要查看其中一种进程：

process where Caption="java.exe"

Caption为列名，等号左右不要加空格

退出：exit

## 解决jar文件不能双击运行的问题

1、双击jar文件报：could not open D:/jre1.5.0/lib/i386/jvm.cfg

环境变量没有配好，经查，无异。如果JDK是安装版本，不是压缩版，在安装的时候会在注册表里面多了些什么东西，果然，在注册表里面找到了javasoft一项，里面配置了JDK,JRE的路径，原来JDK直接读的注册表里面的变量，忽略了系统环境变量。

解决办法：

卸载jdk，改成直接配置环境变量的模式

2、配置好环境变量后，打开时打开的是打开方式列表，还是无法运行的解决方法：

    1、选择默认程序：右击jar包，打开方式->选择默认程序->浏览，选中jre下bin文件中javaw.exe(比如我的javaw.exe在D:\Program Files\Java\jre6\bin下）。

    2、编辑注册 表：HKEY_CLASSES_ROOT\Applications\javaw.exe\shell\open\command,修改数据数值为"D: \Program Files\Java\jdk1.6.0_21\jre\bin\javaw.exe" -jar "%1"（只要在原来的数值下添加-jar即可）。

大功告成,jar文件就可以直接运行了。

## 如何查询端口用及停止程序的方被占法

端口如果被其他程序占用就不能正常启动，比如有时启动时会提示WEB启动失败，其实就是80端口被占用了，而迅雷等下载软件恰恰就是占用了80端口，关掉就行了。但有时迅雷等都没有开也启动不了，那就是别的东西占用了，那怎么办呢？我来叫你查看端口并关掉的方法。

1. 在开始--运行 里面输入cmd点回车，会出现运行窗口。

2. 在提示符后输入netstat -ano回车，找到tcp 80端口对应的pid，比如1484.

    -a 表示显示所有活动的TCP连接以及计算机监听的TCP和UDP端口。

    -e 表示显示以太网发送和接收的字节数、数据包数等。

    -n 表示只以数字形式显示所有活动的TCP连接的地址和端口号。

    -o 表示显示活动的TCP连接并包括每个连接的进程ID（PID）。

    -s 表示按协议显示各种连接的统计信息，包括端口号。

3.ctrl+alt+del打开任务管理器，选进程，这里有很多正在运行的程序怎么找？别急点上面的 查看--选择列--在PID（进程标示符）前面打钩。好了，下面的进程前面都有了PID号码。这时上一步找到的PID就有用了，找到1484，比如 PEER.EXE什么的，结束进程吧。这时再开服务器，看WEB可以启动了！

关闭/开启端口

在介绍各种端口的作用前，这里先介绍一下在Windows中如何关闭/打开端口，因为默认的情况下，有很多不安全的或没有什么用的端口是开启的，比如 Telnet服务的23端口、FTP服务的21端口、SMTP服务的25端口、RPC服务的135端口等等。为了保证系统的安全性，我们可以通过下面的方 法来关闭/开启端口。

【附：】

关闭端口

比如在Windows 2000/XP中关闭SMTP服务的25端口，可以这样做：首先打开“控制面板”，双击“管理工具”，再双击“服务”。接着在打开的服务窗口中找到并双击 “Simple Mail Transfer Protocol （SMTP）”服务，单击“停止”按钮来停止该服务，然后在“启动类型”中选择“已禁用”，最后单击“确定”按钮即可。这样，关闭了SMTP服务就相当于 关闭了对应的端口。

开启端口

如果要开启该端口只要先在“启动类型”选择“自动”，单击“确定”按钮，再打开该服务，在“服务状态”中单击“启动”按钮即可启用该端口，最后，单击“确定”按钮即可。

21端口：21端口主要用于FTP（File Transfer Protocol，文件传输协议）服务。

23端口：23端口主要用于Telnet（远程登录）服务，是Internet上普遍采用的登录和仿真程序。

25端口：25端口为SMTP（Simple Mail Transfer Protocol，简单邮件传输协议）服务器所开放，主要用于发送邮件，如今绝大多数邮件服务器都使用该协议。

53端口：53端口为DNS（Domain Name Server，域名服务器）服务器所开放，主要用于域名解析，DNS服务在NT系统中使用的最为广泛。

67、68端口：67、68端口分别是为Bootp服务的Bootstrap Protocol Server（引导程序协议服务端）和Bootstrap Protocol Client（引导程序协议客户端）开放的端口。

69端口：TFTP是Cisco公司开发的一个简单文件传输协议，类似于FTP。

79端口：79端口是为Finger服务开放的，主要用于查询远程主机在线用户、操作系统类型以及是否缓冲区溢出等用户的详细信息。 80端口：

80端口是为HTTP（HyperText Transport Protocol，超文本传输协议）开放的，这是上网冲浪使用最多的协议，主要用于在WWW（World Wide Web，万维网）服务上传输信息的协议。

99端口：99端口是用于一个名为“Metagram Relay”（亚对策延时）的服务，该服务比较少见，一般是用不到的。

109、110端口：109端口是为POP2（Post Office Protocol Version 2，邮局协议2）服务开放的，110端口是为POP3（邮件协议3）服务开放的，POP2、POP3都是主要用于接收邮件的。

111端口：111端口是SUN公司的RPC（Remote Procedure Call，远程过程调用）服务所开放的端口，主要用于分布式系统中不同计算机的内部进程通信，RPC在多种网络服务中都是很重要的组件。

113端口：113端口主要用于Windows的“Authentication Service”（验证服务）。

119端口：119端口是为“Network News Transfer Protocol”（网络新闻组传输协议，简称NNTP）开放的。

135端口：135端口主要用于使用RPC（Remote Procedure Call，远程过程调用）协议并提供DCOM（分布式组件对象模型）服务。

137端口：137端口主要用于“NetBIOS Name Service”（NetBIOS名称服务）。

139端口：139端口是为“NetBIOS Session Service”提供的，主要用于提供Windows文件和打印机共享以及Unix中的Samba服务。 143端口：143端口主要是用于“Internet Message Access Protocol”v2（Internet消息访问协议，简称IMAP）。

161端口：161端口是用于“Simple Network Management Protocol”（简单网络管理协议，简称SNMP）。

443端口：43端口即网页浏览端口，主要是用于HTTPS服务，是提供加密和通过安全端口传输的另一种HTTP。

554端口：554端口默认情况下用于“Real Time Streaming Protocol”（实时流协议，简称RTSP）。

1024端口：1024端口一般不固定分配给某个服务，在英文中的解释是“Reserved”（保留）。

1080端口：1080端口是Socks代理服务使用的端口，大家平时上网使用的WWW服务使用的是HTTP协议的代理服务。

1755端口：1755端口默认情况下用于“Microsoft Media Server”（微软媒体服务器，简称MMS
4000端口：4000端口是用于大家经常使用的QQ聊天工具的，再细说就是为QQ客户端开放的端口，QQ服务端使用的端口是8000。

5554端口：在今年4月30日就报道出现了一种针对微软lsass服务的新蠕虫病毒——震荡波（Worm.Sasser），该病毒可以利用TCP 5554端口开启一个FTP服务，主要被用于病毒的传播。

5632端口：5632端口是被大家所熟悉的远程控制软件pcAnywhere所开启的端口。

8080端口：8080端口同80端口，是被用于WWW代理服务的，可以实现网页端口概念

在网络技术中，端口（Port）大致有两种意思：

一是物理意义上的端口，比如，ADSL Modem、集线器、交换机、路由器用于连接其他网络设备的接口，如RJ-45端口、SC端口等等。

二是逻辑意义上的端口，一般是指TCP/IP协议中的端口，端口号的范围从0到65535，比如用于浏览网页服务的80端口，用于FTP服务的21端口等 等。我们这里将要介绍的就是逻辑意义上的端口。 端口分类 逻辑意义上的端口有多种分类标准，下面将介绍两种常见的分类：

1. 按端口号分布划分

（1）知名端口（Well-Known Ports） 

知名端口即众所周知的端口号，范围从0到1023，这些端口号一般固定分配给一些服务。比如21端口分配给FTP服务，25端口分配给SMTP（简单邮件 传输协议）服务，80端口分配给HTTP服务，135端口分配给RPC（远程过程调用）服务等等。

（2）动态端口（Dynamic Ports） 

动态端口的范围从1024到65535，这些端口号一般不固定分配给某个服务，也就是说许多服务都可以使用这些端口。只要运行的程序向系统提出访问网络的 申请，那么系统就可以从这些端口号中分配一个供该程序使用。比如1024端口就是分配给第一个向系统发出申请的程序。在关闭程序进程后，就会释放所占用的 端口号。 不过，动态端口也常常被病毒木马程序所利用，如冰河默认连接端口是7626、WAY 2.4是8011、Netspy 3.0是7306、YAI病毒是1024等等。

2. 按协议类型划分 按协议类型划分，可以分为TCP、UDP、IP和ICMP（Internet控制消息协议）等端口。下面主要介绍TCP和UDP端口： 

（1）TCP端口 TCP端口，即传输控制协议端口，需要在客户端和服务器之间建立连接，这样可以提供可靠的数据传输。常见的包括FTP服务的21端口，Telnet服务的 23端口，SMTP服务的25端口，以及HTTP服务的80端口等等。

（2）UDP端口 UDP端口，即用户数据包协议端口，无需在客户端和服务器之间建立连接，安全性得不到保障。常见的有DNS服务的53端口，SNMP（简单网络管理协议）服务的161端口，QQ使用的8000和4000端口等等。

查看端口 在Windows 2000/XP/Server 2003中要查看端口，可以使用Netstat命令： 

依次点击“开始→运行”，键入“cmd”并回车，打开命令提示符窗口。在命令提示符状态下键入“netstat -a -n”，按下回车键后就可以看到以数字形式显示的TCP和UDP连接的端口号及状态（如图）。

79端口 端口说明：79端口是为Finger服务开放的，主要用于查询远程主机在线用户、操作系统类型以及是否缓冲区溢出等用户的详细信息。比如要显示远程计算机www.abc.com 上 的user01用户的信息，可以在命令行中键入“finger [url=mailto:user01@www.abc.com]user01@www.abc.com[/url]”即可。

端口漏洞：一般黑客要攻击对方的计算机，都是通过相应的端口扫描工具来获得相关信息，比如使用“流光”就可以利用79端口来扫描远程计算机操作系统版本， 获得用户信息，还能探测已知的缓冲区溢出错误。这样，就容易遭遇到黑客的攻击。而且，79端口还被Firehotcker木马作为默认的端口。 操作建议：建议关闭该端口。 80端口 端口说明：80端口是为HTTP（HyperText Transport Protocol，超文本传输协议）开放的，这是上网冲浪使用最多的协议，主要用于在WWW（World Wide Web，万维网）服务上传输信息的协议。我们可以通过HTTP地址加“:80”（即常说的“网址”）来访问网站的，比如http://www.cce.com.cn:80 ， 因为浏览网页服务默认的端口号是80，所以只要输入网址，不用输入“:80”。 端口漏洞：有些木马程序可以利用80端口来攻击计算机的，比如Executor、RingZero等。 操作建议：为了能正常上网冲浪，我们必须开启80端口。 109与110端口 端口说明：109端口是为POP2（Post Office Protocol Version 2，邮局协议2）服务开放的，110端口是为POP3（邮件协议3）服务开放的，POP2、POP3都是主要用于接收邮件的，目前POP3使用的比较多， 许多服务器都同时支持POP2和POP3。客户端可以使用POP3协议来访问服务端的邮件服务，如今ISP的绝大多数邮件服务器都是使用该协议。在使用电 子邮件客户端程序的时候，会要求输入POP3服务器地址，默认情况下使用的就是110端口（如图）。 

端口漏洞：POP2、POP3在提供邮件接收服务的同时，也出现了不少的漏洞。单单POP3服务在用户名和密码交换缓冲区溢出的漏洞就不少于20个，比如 WebEasyMail POP3 Server合法用户名信息泄露漏洞，通过该漏洞远程攻击者可以验证用户账户的存在。另外，110端口也被ProMail trojan等木马程序所利用，通过110端口可以窃取POP账号用户名和密码。 操作建议：如果是执行邮件服务器，可以打开该端口。 135端口 端口说明：135端口主要用于使用RPC（Remote Procedure Call，远程过程调用）协议并提供DCOM（分布式组件对象模型）服务，通过RPC可以保证在一台计算机上运行的程序可以顺利地执行远程计算机上的代 码；使用DCOM可以通过网络直接进行通信，能够跨包括HTTP协议在内的多种网络传输。 端口漏洞：相信去年很多Windows 2000和Windows XP用户都中了“冲击波”病毒，该病毒就是利用RPC漏洞来攻击计算机的。RPC本身在处理通过TCP/IP的消息交换部分有一个漏洞，该漏洞是由于错误 地处理格式不正确的消息造成的。该漏洞会影响到RPC与DCOM之间的一个接口，该接口侦听的端口就是135。 操作建议：为了避免“冲击波”病毒的攻击，建议关闭该端口 137端口 端口说明：137端口主要用于“NetBIOS Name Service”（NetBIOS名称服务），属于UDP端口，使用者只需要向局域网或互联网上的某台计算机的137端口发送一个请求，就可以获取该计算 机的名称、注册用户名，以及是否安装主域控制器、IIS是否正在运行等信息。 

端口漏洞：因为是UDP端口，对于攻击者来说，通过发送请求很容易就获取目标计算机的相关信息，有些信息是直接可以被利用，并分析漏洞的，比如IIS服 务。另外，通过捕获正在利用137端口进行通信的信息包，还可能得到目标计算机的启动和关闭的时间，这样就可以利用专门的工具来攻击。 操作建议：建议关闭该端口。 139端口 端口说明：139端口是为“NetBIOS Session Service”提供的，主要用于提供Windows文件和打印机共享以及Unix中的Samba服务。在Windows中要在局域网中进行文件的共享， 必须使用该服务。比如在Windows 98中，可以打开“控制面板”，双击“网络”图标，在“配置”选项卡中单击“文件及打印共享”按钮选中相应的设置就可以安装启用该服务；在Windows 2000/XP中，可以打开“控制面板”，双击“网络连接”图标，打开本地连接属性；接着，在属性窗口的“常规”选项卡中选择“Internet协议 （TCP/IP）”，单击“属性”按钮；然后在打开的窗口中，单击“高级”按钮；在“高级TCP/IP设置”窗口中选择“WINS”选项卡，在 “NetBIOS设置”区域中启用TCP/IP上的NetBIOS。 

端口漏洞：开启139端口虽然可以提供共享服务，但是常常被攻击者所利用进行攻击，比如使用流光、SuperScan等端口扫描工具，可以扫描目标计算机 的139端口，如果发现有漏洞，可以试图获取用户名和密码，这是非常危险的 


